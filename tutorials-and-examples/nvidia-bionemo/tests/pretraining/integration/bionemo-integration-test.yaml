apiVersion: batch/v1
kind: Job
metadata:
  name: bionemo-integration-test
spec:
  template:
    spec:
      containers:
      - name: test-runner
        image: nvcr.io/nvidia/clara/bionemo-framework:2.1
        command: ["/bin/bash", "-c"]
        args:
        - |
          # Test data download
          download_bionemo_data esm2/testdata_esm2_pretrain:2.0 --source ngc
          if [ $? -ne 0 ]; then exit 1; fi
          
          # Test GPU availability
          nvidia-smi
          if [ $? -ne 0 ]; then exit 1; fi
          
          # Test volume mount
          if [ ! -d "/mnt/data" ]; then exit 1; fi
        resources:
          limits:
            nvidia.com/gpu: 1
        volumeMounts:
        - name: fileserver
          mountPath: /mnt/data
      restartPolicy: Never