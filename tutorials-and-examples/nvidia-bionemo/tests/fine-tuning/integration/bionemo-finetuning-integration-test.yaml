apiVersion: batch/v1
kind: Job
metadata:
  name: bionemo-finetuning-integration-test
spec:
  template:
    spec:
      containers:
      - name: test-runner
        image: nvcr.io/nvidia/clara/bionemo-framework:2.1
        command: ["/bin/bash", "-c"]
        args:
        - |
          # Test GPU availability
          nvidia-smi
          if [ $? -ne 0 ]; then exit 1; fi
          
          # Test volume mounts
          if [ ! -d "/workspace/bionemo2" ]; then exit 1; fi
          
          # Test finetuning script presence
          if [ ! -f "/workspace/bionemo2/finetuning.py" ]; then exit 1; fi
        resources:
          limits:
            nvidia.com/gpu: 1
        volumeMounts:
        - name: bionemo-storage
          mountPath: /workspace/bionemo2
          subPath: finetuning
      restartPolicy: Never