apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../base
images:
- name: controller
  newName: us-docker.pkg.dev/cool-machine-learning/default/autometric-failover-controller
  newTag: 705105a
patches:
# Workload Identity:
- target:
    kind: ServiceAccount
    name: controller
    namespace: autometric-failover-system
  patch: |-
    - op: add
      path: /metadata/annotations/iam.gke.io~1gcp-service-account
      value: autometric-failover-controller@cool-machine-learning.iam.gserviceaccount.com
